select * from yellow_taxi_trips limit 100
select * from zone_lookup limit 100

select count(1) from zone_lookup where zone_lookup."Borough" is null
select count(1) from yellow_taxi_trips where yellow_taxi_trips."PULocationID" is null

-- Q1
select count(1) from yellow_taxi_trips
where lpep_pickup_datetime >= '2019-09-18 00:00:00'
and lpep_dropoff_datetime < '2019-09-19 00:00:00'

-- Q2
select * from yellow_taxi_trips where trip_distance = 
(select max(trip_distance) from yellow_taxi_trips)

-- Q3
select z."Borough", sum(y.total_amount) as amounts from yellow_taxi_trips y 
join zone_lookup z
on y."PULocationID" = z."LocationID"
where CAST(lpep_pickup_datetime AS DATE) = '2019-09-18' and z."Borough" != 'Unknown'
group by z."Borough"
-- having y.total_amount > 50000
order by amounts desc


select z."Zone"
from yellow_taxi_trips y 
join zone_lookup z
	on y."PULocationID" = z."LocationID"
	and z."Zone" = 'Astoria'
where to_char(lpep_pickup_datetime, 'YYYY-MM') = '2019-09'
and y.tip_amount = (
select max(y.tip_amount)
from yellow_taxi_trips y 
join zone_lookup z
	on y."PULocationID" = z."LocationID"
	and z."Zone" = 'Astoria'
where to_char(lpep_pickup_datetime, 'YYYY-MM') = '2019-09'
)

select "Zone" from zone_lookup 
where "LocationID"= 132


